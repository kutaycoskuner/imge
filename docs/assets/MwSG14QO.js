import{i as E,u as J,_ as K}from"./uA88Jj9G.js";import{_ as A,r,q as p,s as j,h as F,o as v,c as _,a as f,t as X,u as Q,g as P,F as M,v as Y,b as B,x as ee,p as te,e as oe}from"./asC6Zurh.js";const se={class:"mouse-tracker"},ne={class:"coordinates"},ae={__name:"CoordTracker",setup(x){const o=E(),b=r(0),S=r(0),L=p(()=>o.get_coordsBaseXOffset),d=p(()=>o.get_coordsBaseYOffset),$=p(()=>o.get_coordsStateXOffset),h=p(()=>o.get_coordsStateYOffset),w=u=>{b.value=u.clientX-L.value-$.value,S.value=-(u.clientY-d.value-h.value)},m=()=>{o.set_coordsBaseXOffset(window.innerWidth/2),o.set_coordsBaseYOffset(window.innerHeight/2)};return j(()=>{m(),window.addEventListener("mousemove",w),window.addEventListener("resize",m)}),F(()=>{window.removeEventListener("mousemove",w),window.removeEventListener("resize",m)}),(u,O)=>(v(),_("div",se,[f("div",ne," x: "+X(b.value)+", y: "+X(S.value),1)]))}},ce=A(ae,[["__scopeId","data-v-fed2d4ea"]]),ue={class:"assistance-msg"},ie={__name:"AssistanceMessage",setup(x){const o=E(),b=p(()=>o.get_assistanceMsg);return(S,L)=>(v(),_("div",ue,X(b.value),1))}},le=A(ie,[["__scopeId","data-v-f682ab49"]]);function de(...x){console.log(...x)}const re={},ve={nodes:[{_id:0,type:"basic",position:{x:-400,y:140},data:{title:"First Node",inputs:[],outputs:[{id:"output_0",type:"basic",label:"Output A"}]}},{_id:1,type:"basic",position:{x:200,y:40},data:{title:"Second Node",inputs:[{id:"input_0",type:"basic",label:"Input A"}],outputs:[]}}],links:[{sourceNodeId:0,sourceOutputId:"output_0",targetNodeId:1,targetInputId:"input_0"}]},Z={metadata:re,data:ve},z=x=>(te("data-v-fe59f40c"),x=x(),oe(),x),_e={class:"content"},fe=["onMousedown"],pe={class:"inputs"},me=["id"],ye=z(()=>f("div",{class:"indicator-io add-input hover-visible"},null,-1)),xe={class:"outputs"},ge=["id"],he=z(()=>f("div",{class:"indicator-io add-output hover-visible"},null,-1)),be=z(()=>f("div",{class:"content"},[f("div",{class:"add-content hover-visible"})],-1)),we={class:"connections",ref:"connectionsSvg"},Se={__name:"index",setup(x){const o=E(),b=J(),S=p(()=>o.get_coordsBaseXOffset),L=p(()=>o.get_coordsBaseYOffset);p(()=>o.get_coordsStateXOffset),p(()=>o.get_coordsStateYOffset);const d=p(()=>o.get_zoomLevel),$=p(()=>o.get_colorMode),h=r(Z.data.nodes),w=r(Z.data.links),m=r(null),u=r(null),O=r(null),g=r({x:0,y:0}),y=r({x:0,y:0}),l=r({x:0,y:0}),R=r(0),q=r(0);function C(e,t){const i=h.value.find(n=>n._id===e);if(o.get_coordsStateXOffset,o.get_coordsStateYOffset,!i)return{x:0,y:0};const s=document.getElementById(`node${e}_${t}`);if(!s)return{x:0,y:0};const a=s.getBoundingClientRect();return{x:a.left+a.width/2,y:a.top+a.height/2}}function U(e){const t=e.target.getBoundingClientRect(),i=t.left+t.width/2,s=t.top+t.height/2;R.value=e.clientX-i,q.value=-(e.clientY-s)}function T(e){e.preventDefault();const a=e.deltaY*-.001;o.set_zoomLevel(Math.min(Math.max(d.value+a,.04),4)),k()}function W(e,t){e.preventDefault(),g.value={x:e.clientX,y:e.clientY};const i=a=>{const n=a.clientX-g.value.x,c=a.clientY-g.value.y;t.position.x+=n/d.value,t.position.y-=c/d.value,g.value={x:a.clientX,y:a.clientY},k(),I()},s=()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)}function D(e){e.preventDefault(),g.value={x:e.clientX,y:e.clientY},m.value&&u.value&&(u.value.style.cursor="grabbing");const t=s=>{const a=s.clientX-g.value.x,n=s.clientY-g.value.y,c=41;y.value={x:y.value.x+a,y:y.value.y+n},l.value={x:l.value.x+a>c||l.value.x+a<-c?l.value.x=0:l.value.x=l.value.x+a,y:l.value.y+n>c||l.value.y+n<-c?l.value.y=0:l.value.y=l.value.y+n},k(),g.value={x:s.clientX,y:s.clientY},o.set_coordsStateXOffset(y.value.x),o.set_coordsStateYOffset(y.value.y)},i=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",i),u.value&&(u.value.style.cursor="grab")};document.addEventListener("mousemove",t),document.addEventListener("mouseup",i)}function V(){o.set_zoomLevel(1),y.value.x=0,y.value.y=0,k()}function H(){de(d.value,d.value<.4);const e=document.getElementsByClassName("polka-dots");e&&(d.value<.4?e[0].style.visibility="hidden":e[0].style.visibility="visible")}function k(){if(u.value&&O.value){u.value.style.transform=`scale(${d.value})`,O.value.style.transform=`translate(${l.value.x}px, ${l.value.y}px) 
            scale(${d.value})`;const e=u.value.querySelector(".content");e&&(e.style.transform=`translate(${y.value.x}px, ${y.value.y}px)`);const t=u.value.querySelector(".connections");t&&(t.style.transform=`scale(${1/d.value})`),I(),H()}}function I(){w.value.forEach(e=>{const t=C(e.sourceNodeId,e.sourceOutputId),i=C(e.targetNodeId,e.targetInputId),s=document.querySelector(`line:nth-child(${w.value.indexOf(e)+1})`);if(s){const a=t.x,n=t.y,c=i.x,N=i.y;s.setAttribute("x1",a),s.setAttribute("y1",n),s.setAttribute("x2",c),s.setAttribute("y2",N)}})}function G(){const e={_id:h.value.length+1,position:{x:100,y:100},data:{title:`Node ${h.value.length+1}`,inputs:[],outputs:[]}};h.value.push(e)}return j(()=>{Q(()=>{I()}),m.value&&(m.value.addEventListener("wheel",T),m.value.addEventListener("mousedown",D))}),F(()=>{u.value&&(u.value.removeEventListener("wheel",T),u.value.removeEventListener("mousedown",D))}),P($,e=>{b.value=e}),P(d,(e,t)=>{k()}),(e,t)=>{const i=ce,s=K,a=le;return v(),_(M,null,[f("div",{class:"viewport",ref_key:"viewport",ref:m},[f("div",{class:"content-wrapper",ref_key:"contentWrapper",ref:u},[f("div",_e,[(v(!0),_(M,null,Y(h.value,n=>(v(),_("div",{key:n._id,class:"node hover-control",style:ee({left:n.position.x+S.value+"px",top:-(n.position.y-L.value)+"px"}),onMousedown:c=>W(c,n),onMouseover:t[0]||(t[0]=c=>U(c))},[f("h3",null,X(n.data.title),1),f("div",pe,[(v(!0),_(M,null,Y(n.data.inputs,(c,N)=>(v(),_("div",{id:`node${n._id}_${c.id}`,key:c.id,class:"node-input"},null,8,me))),128)),ye]),f("div",xe,[(v(!0),_(M,null,Y(n.data.outputs,(c,N)=>(v(),_("div",{id:`node${n._id}_${c.id}`,key:c.id,class:"node-output"},null,8,ge))),128)),he]),be],44,fe))),128))]),(v(),_("svg",we,[(v(!0),_(M,null,Y(w.value,(n,c)=>(v(),_("line",{key:c,stroke:"currentColor","stroke-width":"2"}))),128))],512))],512),f("div",{class:"polka-dots",ref_key:"background",ref:O},null,512)],512),B(i),B(s,{onFitToScreen:V,onAddNode:G}),B(a)],64)}}},Le=A(Se,[["__scopeId","data-v-fe59f40c"]]);export{Le as default};
